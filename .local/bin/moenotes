#!/bin/sh

DIR="$HOME/Documents/Notes"
# preview lines max
LINE=5

[ ! -d "$DIR" ] && mkdir "$DIR"
cd "$DIR" || exit

help()
{
    cat << EOF
Moe Notes

Usage: moenotes [OPT]
       -s --show              - show all notes
       -d --delete [filename] - delete note
       -o --open [filename]   - open/edit note
       -h --help              - show help

Example: moenotes --open file1.txt
EOF
}

case "$1" in
"-d" | "--delete")
    [ -z "$2" ] && exit
    
    rm -i "$2"
    ;;

"-o" | "--open")
    if [ -z "$2" ];
    then
        cd "$DIR" || exit
        $EDITOR
        exit
    fi
    
    $EDITOR + "$DIR/$2"
    ;;

"-s" | "--show")
	clear
	for i in $(find "$DIR"/* | sort -r);
	do
	    echo "--------"
	    echo "[$i]"
	    echo "--------"
	    if [ "$( file -b --mime-type "$i" | sed 's|/.*||')" != "text" ];
	    then
	        echo "-- cannot read this file --"
	    else
	        head -n "$LINE" "$i"
	    fi
	    echo
	done | less
	;;

"-h" | "--help")
    help
    exit 0
	;;

*)
    echo "Invalid argument!"
    echo
    help
    exit 1
	;;
esac
