#!/bin/sh


#------------------------------------------------------#
help_msg() {
    cat << EOF
chdns [OPT] [DNS]
      -e    - Print /etc/resolv.conf contents
      -s    - Set dns
      -a    - Append dns
      -h    - Show help

Examples:
      chdns -e
      chdns -s 127.0.0.1
      chdns -a 127.0.0.1

EOF
}


err()
{
	printf "%s\n\n" "Invalid argument!" >&2
	help_msg >&2

	exit 1
}


set_dns()
{
	cat << EOF > /etc/resolv.conf
# Generated by chnds
nameserver $1

EOF
}


append_dns()
{
	cat << EOF >> /etc/resolv.conf
nameserver $1

EOF
}


#------------------------------------------------------#
case "$1" in
"-e")
	cat /etc/resolv.conf
	;;

"-s")
	[ -z "$2" ] && err

	if set_dns "$2"
	then
		echo "Done!"
	fi
	;;

"-a")
	[ -z "$2" ] && err

	if append_dns "$2"
	then
		echo "Done!"
	fi
	;;

"-h" | *)
	help_msg
	;;
esac

exit 0


